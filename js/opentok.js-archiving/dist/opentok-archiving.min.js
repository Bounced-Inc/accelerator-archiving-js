(function(){var e;e="object"==typeof module&&"object"==typeof module.exports?require("jquery"):this.$;var n,t,i,o,r,c=!1,a=!1,s=function(e,n){o&&o.triggerEvent(e,n)},d=function(e){var n=new Date(null);n.setSeconds(e.duration);var t=n.toISOString().substr(11,8),i=['<div id="otsArchivingModal" class="ots-archiving-modal">','<div class="modal-content">',"<div>",'<span id="closeArchiveModal" class="close-button">Ã—</span>','<h2 class="archive-name">'+e.name+"</h2>","<a href="+e.url+' class="download" target="_blank">Download Archive</a>',"</div>","<div>",'<span class="date-time"> File size: </span>','<span class="archive-information">'+e.size/1e3+" Mb</span>","</br>",'<span class="date-time"> Duration: </span>','<span class="archive-information">'+t+"</span>","</br>","</div>","</div>","</div>"].join("\n"),o=document.querySelector("#otsWidget"),r=document.createElement("div");r.innerHTML=i;var c=r.firstChild;o.appendChild(c);var a=document.getElementById("otsArchivingModal"),s=document.getElementById("closeArchiveModal");a.style.display="block",s.onclick=function(){a.style.display="none"}},l=function(){e.post(n,{sessionId:r.id}).then(function(e){i=e,s("startArchive",e)}).fail(function(e){s("archiveError",e)})},v=function(){e.post(t,{archiveId:i.id}).then(function(e){d(e),s("stopArchive",e)}).fail(function(e){s("archiveError",e)})},u=function(e){var n=document.querySelector(e),t='<div class="ots-video-control circle archiving enabled" id="enableArchiving"></div>',i=document.createElement("div");i.innerHTML=t;var o=i.firstChild;n.appendChild(o),a=!0,o.onclick=function(){c?(c=!1,document.querySelector("#enableArchiving").classList.remove("active"),v()):(c=!0,document.querySelector("#enableArchiving").classList.add("active"),l())}},h=function(){var e=["startArchive","endArchive","archiveError"];o.registerEvents(e)},f=function(){o.registerEventListener("startCall",function(){a?document.getElementById("enableArchiving").classList.remove("ots-hidden"):u()}),o.registerEventListener("endCall",function(){document.getElementById("enableArchiving").classList.add("ots-hidden")})},m=function(e){var i=["session","startURL","stopURL"];i.forEach(function(n){if(!e[n])throw new Error(["OT: Archiving Accelerator Pack requires a",n].join(""))}),r=e.session,n=e.startURL,t=e.stopURL,o=e.accPack},p=function(e){m(e);var n=e.controlsContainer||"#feedControls";u(n),h(),f()};p.prototype={constructor:p},"object"==typeof exports?module.exports=p:"function"==typeof define&&define.amd?define(function(){return p}):this.ArchivingAccPack=p}).call(this);